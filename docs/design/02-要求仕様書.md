# がんばりクエスト 要求仕様書

| 項目 | 内容 |
|------|------|
| 版数 | 1.0 |
| 作成日 | 2026-02-19 |
| 作成者 | 日下武紀 |

---

## 1. 文書の目的・位置付け

本文書は「がんばりクエスト」の要求仕様書であり、企画書で定めたサービスコンセプトを具体的な要求レベルに落とし込む。要件定義書（04）および各設計書の入力ドキュメントとなる。

---

## 2. サービス概要

### サービスコンセプト

子供の日常活動をゲーミフィケーションで動機付けし、成長を可視化する家庭内専用Webアプリケーション。

### 想定利用環境

| 項目 | 内容 |
|------|------|
| 利用端末 | タブレット（子供用）、スマートフォン/PC（親用） |
| 通信環境 | 家庭内LAN限定（インターネット不要。Gemini API利用時のみ外部通信） |
| ブラウザ | Chrome/Safari/Edge の最新版 |
| 画面サイズ | タブレット（10インチ前後）を最適化対象。スマホ・PCも対応 |

---

## 3. 利用シナリオ・ペルソナ

### ペルソナ A: お嬢様（4歳・保育園児）

- **朝**: 起床 → 着替え完了 → アプリで「着替えた」アイコンをタップ → ポイント表示 → 笑顔
- **帰宅後**: お手伝い（食器運び）→ アプリで「お手伝い」アイコンをタップ → レベルアップ演出
- **週末**: 「今週のがんばり」画面を親と一緒に確認 → キャラクターの成長を確認

### ペルソナ B: 父（35歳・IT技術者）

- **随時**: 新しい活動を管理画面から追加（「図書館に行った」など）
- **週末**: 子供のステータスを確認。ポイントが500以上ならお小遣いに変換
- **月次**: 市場比較を確認。成長トレンドを把握

### ペルソナ C: 母

- **日常**: 子供と一緒にアプリを操作。活動記録をサポート
- **管理**: 不要な活動の非表示設定。ポイント変換

---

## 4. 適用範囲・前提条件

### 適用範囲

- 子供が行う日常活動の記録・評価・ゲーミフィケーション
- ポイントによるお小遣い管理
- 一般市場との比較によるステータス可視化

### 適用外

- 学校の成績管理（テスト結果の入力等は対象外）
- 家計管理（親の家計簿機能は含まない）
- SNS機能（家族外への共有機能は含まない）

### 前提条件

- 家庭内LANにNUCサーバー（Windows）が常時稼働している
- 子供用タブレットが用意されている
- Gemini API キーが取得済み

---

## 5. ステークホルダー

| ステークホルダー | 関心事 |
|-----------------|--------|
| お嬢様（4歳） | 楽しい！かわいい！もっとやりたい！ |
| 坊ちゃま（0歳→成長後） | 姉と同じように使いたい |
| 父 | 子供の成長促進、技術的な運用・保守 |
| 母 | 子供と楽しく使える、管理が簡単 |

---

## 6. ビジネス／ユーザー要求

### BR-1: 子供の自発的な活動促進

子供が「やらされている」のではなく「やりたい！」と思えるゲーミフィケーション体験を提供すること。

### BR-2: 活動の客観的評価

一般市場（同年齢の平均）と比較し、子供の活動がどれだけ価値があるかを客観的に示すこと。

### BR-3: 公平なお小遣い管理

活動量に応じた歩合制報酬（1ポイント＝1円）により、頑張りと報酬を直結させること。

### BR-4: 家族全員の使いやすさ

4歳児が文字を読めなくても使えるUI。親も少ない操作で管理できること。

### BR-5: データの安全性

活動記録・ステータスデータが失われないよう、冗長化（ローカル＋GitHub）を行うこと。

---

## 7. 機能要求

### 機能一覧

| ID | 機能名 | 対象 | 優先度 | 概要 |
|----|--------|------|--------|------|
| FR-01 | 活動記録 | 子供 | 必須 | 最大2タップで活動を記録する |
| FR-02 | 活動記録キャンセル | 子供 | 必須 | 誤った記録を即座にキャンセルする |
| FR-03 | 活動履歴表示 | 子供 | 必須 | 今週/今月/今年の活動を一覧表示 |
| FR-04 | ステータス表示 | 子供 | 必須 | 現在のステータス値・レベル・キャラクターを表示 |
| FR-05 | 市場比較表示 | 子供/親 | 必須 | 一般市場の偏差値との比較を表示 |
| FR-06 | 子供別ページ | 子供 | 必須 | 子供ごとに色味・テーマが異なる専用ページ |
| FR-07 | 週次自動評価 | 自動 | 必須 | 週次で活動を評価しポイントを自動付与 |
| FR-08 | ステータス自動減少 | 自動 | 必須 | 未活動期間に応じてステータスを減少させる |
| FR-09 | 活動管理（追加/編集） | 親 | 必須 | 新しい活動カテゴリを追加・編集する |
| FR-10 | 活動表示/非表示切替 | 親 | 必須 | 任意の活動を表示・非表示にする |
| FR-11 | 年齢別自動非表示 | 自動 | 重要 | 年齢に適さない活動を自動的に非表示にする |
| FR-12 | ポイント→お小遣い変換 | 親 | 必須 | 500ポイント単位でお小遣いに変換する |
| FR-13 | 管理画面PIN認証 | 親 | 必須 | 管理画面へのアクセスにPINコードを要求する |
| FR-14 | キャラクター表示 | 子供 | 重要 | ステータスに応じたキャラクター（ヒーロー/勉強中等）を表示 |
| FR-15 | レベルアップ演出 | 子供 | 重要 | レベルアップ時にアニメーション演出を表示 |
| FR-16 | データバックアップ | 自動 | 必須 | SQLiteデータのGitHub自動バックアップ |
| FR-17 | キャラクター画像生成 | 自動 | 任意 | Gemini APIによるキャラクター画像の動的生成 |

### 機能詳細

#### FR-01: 活動記録

| 項目 | 内容 |
|------|------|
| 入力 | 子供が活動アイコンをタップ |
| 処理 | 活動ログを作成し、ポイントを仮付与 |
| 出力 | 記録完了のフィードバック（アニメーション＋効果音的な演出） |
| エラー | タップミス → キャンセルボタン表示（FR-02と連動） |

**操作フロー:**
1. ホーム画面に活動アイコン一覧を表示
2. 子供が該当アイコンをタップ（1タップ目）
3. 確認画面で「やった！」ボタンをタップ（2タップ目）
4. 記録完了 + ポイント表示 + 「キャンセル」ボタン表示（5秒間）

#### FR-04: ステータス表示

| 項目 | 内容 |
|------|------|
| 表示要素 | レベル、各ステータス値（運動、勉強、お手伝い等）、キャラクター |
| 比較 | 一般市場の偏差値との差をビジュアルで表現 |
| レベル計算 | 全ステータス値の総合値から算出 |

**ビジュアル指針:**
- 偏差値55以上（標準偏差+0.5σ以上）→ ヒーローキャラクター表示
- 偏差値45〜55（標準的）→ 通常キャラクター表示
- 偏差値45未満（標準偏差-0.5σ以下）→ がんばり中キャラクター表示

#### FR-08: ステータス自動減少

| 項目 | 内容 |
|------|------|
| トリガー | 日次バッチ（深夜0時） |
| 基礎減少 | 1日未活動で基礎減少値（年齢別係数×基礎値） |
| 加速減少 | 連続N日未活動で減少量が加速（基礎減少 + α×(N-1)） |
| 年齢係数 | 20歳まで減りにくい。年齢が低いほど係数小 |
| 上限 | ステータス値は0以下にならない |

**年齢別係数の目安:**
| 年齢 | 基礎係数 | 備考 |
|------|----------|------|
| 0-6歳 | 0.3 | 非常に減りにくい |
| 7-12歳 | 0.5 | 減りにくい |
| 13-18歳 | 0.7 | 標準的 |
| 19-20歳 | 0.9 | やや減りやすい |

※ αの設計は学術調査後に確定（チケット#0015で詳細化）

#### FR-12: ポイント→お小遣い変換

| 項目 | 内容 |
|------|------|
| 変換単位 | 500ポイント単位 |
| 変換レート | 1ポイント＝1円 |
| 処理 | ポイント残高から500P減算、変換履歴に記録 |
| 実際の支払い | アプリ外で行う（現金 or 別アプリ） |
| 制約 | 残高が500P未満の場合は変換不可 |

---

## 8. 非機能要求

### NFR-01: 利用デバイス・OS

| 項目 | 要求 |
|------|------|
| 対象ブラウザ | Chrome, Safari, Edge の最新2バージョン |
| 最適化対象 | タブレット（10インチ前後）のタッチ操作 |
| レスポンシブ | スマートフォン〜PC（親の管理画面用） |

### NFR-02: 性能

| 項目 | 要求 |
|------|------|
| ページ表示 | 初回ロード3秒以内（LAN内） |
| 操作応答 | タップから画面更新まで500ms以内 |
| 同時利用 | 家族4名（実質的に2〜3端末同時） |

### NFR-03: セキュリティ・プライバシー

| 項目 | 要求 |
|------|------|
| ネットワーク | 家庭内LANのみアクセス可能 |
| 認証 | 管理画面のみPINコード認証（4〜6桁） |
| データ保存 | ローカルSQLiteのみ。クラウド送信しない（Gemini API除く） |
| PINコード | ハッシュ化して保存 |

### NFR-04: 信頼性・可用性

| 項目 | 要求 |
|------|------|
| 稼働時間 | NUCサーバー稼働中は常時利用可能 |
| データ損失 | SQLite + Git自動バックアップにより防止 |
| 障害復旧 | Git上のバックアップから最大24時間以内に復旧可能 |

### NFR-05: ユーザビリティ

| 項目 | 要求 |
|------|------|
| 操作性 | 4歳児が文字を読まずに操作できるアイコンベースUI |
| タップターゲット | 最低48x48px（W3C WCAG準拠） |
| フィードバック | タップ時の即座な視覚フィードバック（色変化、アニメーション） |
| 子供別UI | 色味・テーマが明らかに異なる専用ページ |
| エラー回復 | 誤操作時に1タップでキャンセル可能 |

### NFR-06: 保守性

| 項目 | 要求 |
|------|------|
| コード品質 | TypeScript strict、Biome によるLint |
| テスト | ユニットテスト + E2Eテスト |
| ドキュメント | 設計書群 + CLAUDE.md/AGENTS.md でセッション間継続性を確保 |
| 変更管理 | Git + チケットベース |

---

## 9. データ・連携要求

### 保存するデータ種別

| データ | 説明 | 保存先 |
|--------|------|--------|
| 子供プロフィール | 名前（ニックネーム）、年齢、テーマ設定 | SQLite |
| 活動マスタ | 活動カテゴリ、アイコン、ポイント計算ルール | SQLite |
| 活動ログ | いつ・誰が・何をしたかの記録 | SQLite |
| ポイント | ポイント残高、付与・消費履歴 | SQLite |
| ステータス | 各能力値の現在値、履歴 | SQLite |
| 評価結果 | 週次評価の結果とスコア | SQLite |
| 市場比較データ | 年齢別の一般平均値・標準偏差 | SQLite |
| 設定 | PINコード（ハッシュ）、システム設定 | SQLite |
| キャラクター画像 | Gemini APIで生成した画像ファイル | ファイルシステム |

### 外部サービス連携

| サービス | 用途 | 通信方向 |
|----------|------|----------|
| Gemini API | キャラクター画像生成 | 送信: プロンプト、受信: 画像データ |
| GitHub | データバックアップ（SQLiteファイル） | 送信: pushのみ |

---

## 10. 制約条件

| 制約 | 内容 |
|------|------|
| プライバシー | 子供の個人情報をクラウドに送信しない（Gemini APIへのプロンプトにも個人情報を含めない） |
| 予算 | 開発費なし（個人開発）。運用費はGemini API無料枠内 |
| 開発体制 | Claude Code + GitHub Copilot。人間の開発者は1名（レビュー・意思決定） |
| デプロイ環境 | NUCサーバー（Windows）のみ |

---

## 11. 品質要求・受入基準

### 重要ユーザーストーリーの受入条件

| ストーリー | 受入条件 |
|-----------|----------|
| 子供が活動を記録する | 2タップ以内で記録完了。記録後にポイント表示 |
| 子供がステータスを確認する | 1タップでステータス画面表示。レベル・キャラクター表示 |
| 親が活動を追加する | 管理画面からPIN認証後、フォームで活動追加 |
| 親がポイントを変換する | 500P単位で変換。変換履歴が残る |
| 週次評価が実行される | 毎週自動実行。ポイントが正しく付与される |

### リリース基準

- E2E テストが全パス
- 主要ユースケースがタブレットで動作確認済み
- お嬢様（4歳）が実際に操作して記録できることを確認

---

## 12. リスク・懸念事項

| リスク | 対策 |
|--------|------|
| 市場比較データの信頼性 | 複数の公的データソースを参照。定期的に更新 |
| ステータス減少ロジックの妥当性 | 初期は緩めの係数で開始。運用しながら調整 |
| 4歳児のUI操作 | MVP段階でユーザーテスト実施。フィードバック反映 |

---

## 13. 変更管理・要件の優先度

### 優先度定義

| 優先度 | 定義 |
|--------|------|
| 必須 | MVP に含める。これがないとサービスとして成立しない |
| 重要 | MVP 後の早期に実装。ユーザー体験を大きく向上させる |
| 任意 | 余裕があれば実装。なくても基本機能は成立する |

### 変更管理

- 要件の変更はチケットを通じて管理
- 変更時は本文書の版数を更新
- CLAUDE.md / AGENTS.md への反映を忘れずに行う
