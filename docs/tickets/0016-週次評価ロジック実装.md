# 週次評価ロジック実装

### ステータス

`Done`

---

### 概要

週次で子供の活動を自動評価し、ポイントを付与するバッチ処理を実装する。

### 背景・動機

活動の評価とポイント付与を自動化し、継続的な動機付けを行う。

### ゴール

- [x] `$lib/server/services/evaluation-service.ts`
- [x] `$lib/server/db/evaluation-repo.ts`
- [x] 評価アルゴリズム（カテゴリ別活動回数→ステータス増加量）
- [x] 自動ポイント付与ロジック（全カテゴリ活動ボーナス: 5cat=20P, 4cat=10P, 3cat=5P）
- [x] 評価結果の保存（evaluationsテーブル）
- [x] 日次ステータス減少バッチ（runDailyDecay）
- [x] 評価履歴取得API (`/api/v1/evaluations/[childId]`)
- [x] ユニットテスト（16件全パス）
- [ ] スケジューラ設定（デプロイ時にcron/タスクスケジューラで設定）

### 作業メモ

- ステータス増加: 7回/週→+3.0, 5回→+2.0, 3回→+1.0, 1回→+0.5
- 全カテゴリ活動ボーナス: 5cat=20P, 4cat=10P, 3cat=5P
- 日次減少: 年齢係数×0.1 + 0.05×(未活動日数-1)
- スケジューラは #0020 デプロイ時に設定

### 成果・結果

- 週次評価サービス（活動集計→ステータス更新→ボーナスポイント付与）
- 日次ステータス減少処理（年齢別係数＋加速減少）
- 評価履歴取得API
- テスト196件全パス（うち評価関連16件）

### 残課題・次のアクション

- スケジューラ設定はデプロイチケット(#0020)で対応
